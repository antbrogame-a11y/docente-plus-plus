<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Web app per la gestione della didattica dell'insegnante potenziata da IA OpenRouter">
    <meta name="theme-color" content="#4a90e2">
    <title>Docente++ - Gestione Didattica con IA</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Icons for iOS & PWA -->
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Docente++">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icons/icon-512x512.png">
    
    <!-- Material Design Icons -->
    <link href="fonts/material-icons.css" rel="stylesheet">
    <!-- Roboto Font -->
    <link href="fonts/roboto.css" rel="stylesheet">
    
    <link rel="stylesheet" href="styles.css">
    <!-- PDF and Excel Export Libraries -->
    <script src="libs/jspdf.umd.min.js"></script>
    <script src="libs/jspdf.plugin.autotable.min.js"></script>
    <script src="libs/xlsx.full.min.js"></script>
    <!-- PapaParse for CSV parsing -->
    <script src="libs/papaparse.min.js"></script>
    <!-- PDF.js for PDF text extraction -->
    <script src="libs/pdf.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'libs/pdf.worker.js';
    </script>
    <!-- JSZip for backup ZIP creation -->
    <script src="libs/jszip.min.js"></script>
</head>
<body>
    <!-- Onboarding Modal -->
    <div id="onboarding-modal" class="modal" style="display: none;">
        <div class="modal-content onboarding-content">
            <h2><span class="material-icons">school</span> Benvenuto in Docente++</h2>
            <p>Configura il tuo profilo per iniziare.</p>
            <form id="onboarding-form">
                <!-- ... Onboarding form fields ... -->
            </form>
        </div>
    </div>

    <div class="container">
        <header>
            <h1><span class="material-icons">school</span> Docente++</h1>
            <p class="subtitle">Gestione Didattica Potenziata da IA</p>
        </header>

        <div class="nav-container">
            <button class="menu-toggle" id="menu-toggle" aria-label="Menu">
                <span></span><span></span><span></span>
            </button>
            <nav class="tabs" id="main-nav">
                <button class="tab-button active" data-tab="home"><span class="material-icons">home</span> Sala Prof</button>
                <button class="tab-button" data-tab="lessons"><span class="material-icons">menu_book</span> Lezioni</button>
                <button class="tab-button" data-tab="activities"><span class="material-icons">assignment</span> Attività</button>
                <button class="tab-button" data-tab="schedule"><span class="material-icons">calendar_today</span> Orario</button>
                <button class="tab-button" data-tab="ai-assistant"><span class="material-icons">smart_toy</span> Assistente IA</button>
                <button class="tab-button" data-tab="document-import"><span class="material-icons">description</span> Importa</button>
            </nav>
        </div>
        
        <div class="menu-backdrop" id="menu-backdrop"></div>

        <!-- Home Tab (Sala Prof) - NEW LAYOUT -->
        <div id="home" class="tab-content active">
            <div class="tab-header">
                <h2><span class="material-icons">home</span> Sala Prof</h2>
                <p>La tua dashboard per la giornata.</p>
            </div>
            
            <div class="home-grid">
                <!-- Main Column -->
                <div class="home-main-column">
                    <!-- Today's Schedule Card -->
                    <div class="home-card" id="home-schedule-card">
                        <div class="card-header">
                            <h3><span class="material-icons">calendar_today</span> Orario di Oggi</h3>
                            <button class="btn btn-sm btn-secondary" onclick="window.app.switchTab('schedule')">Vista completa</button>
                        </div>
                        <div id="home-today-schedule" class="card-content">
                            <!-- Dynamic content will be injected here -->
                            <p class="placeholder">Nessuna lezione programmata per oggi.</p>
                        </div>
                    </div>
                </div>

                <!-- Side Column -->
                <div class="home-side-column">
                    <!-- Things To Do Card -->
                    <div class="home-card" id="home-todo-card">
                        <div class="card-header">
                            <h3><span class="material-icons">check_circle</span> Cose da Fare</h3>
                        </div>
                        <div id="home-todo-list" class="card-content">
                             <!-- Dynamic content will be injected here -->
                            <p class="placeholder">Nessuna attività in scadenza.</p>
                        </div>
                    </div>

                    <!-- AI Suggestions Card -->
                    <div class="home-card" id="home-ai-card">
                        <div class="card-header">
                            <h3><span class="material-icons">smart_toy</span> Suggerimenti IA</h3>
                            <button class="btn btn-sm btn-icon" onclick="window.app.refreshAISuggestions()" title="Aggiorna suggerimenti">
                                <span class="material-icons">refresh</span>
                            </button>
                        </div>
                        <div id="home-ai-suggestions" class="card-content">
                            <!-- Dynamic content will be injected here -->
                            <p class="placeholder">L'IA sta pensando...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Lessons Tab -->
        <div id="lessons" class="tab-content">
            <div class="tab-header">
                <h2><span class="material-icons">menu_book</span> Gestione Lezioni</h2>
            </div>
            <div class="section-actions">
                <button class="btn btn-primary" onclick="app.showAddLessonForm()"><span class="material-icons">add</span> Nuova Lezione</button>
                <button class="btn btn-secondary" onclick="app.generateLessonWithAI()"><span class="material-icons">smart_toy</span> Genera con IA</button>
            </div>
            <div id="lessons-list"></div>
        </div>

        <!-- Activities Tab -->
        <div id="activities" class="tab-content">
             <div class="tab-header">
                <h2><span class="material-icons">assignment</span> Gestione Attività</h2>
            </div>
             <div class="section-actions">
                <button class="btn btn-primary" onclick="app.showAddActivityForm()"><span class="material-icons">add</span> Nuova Attività</button>
            </div>
            <div id="activities-list"></div>
        </div>

        <!-- Schedule Tab -->
        <div id="schedule" class="tab-content">
            <div class="tab-header">
                <h2><span class="material-icons">calendar_today</span> Orario Settimanale</h2>
            </div>
            <div id="schedule-container"></div>
        </div>

        <!-- AI Assistant Tab -->
        <div id="ai-assistant" class="tab-content">
            <div class="tab-header">
                <h2><span class="material-icons">smart_toy</span> Assistente IA</h2>
            </div>
            <div class="ai-container">
                <div class="ai-chat">
                    <div class="chat-messages" id="ai-chat-messages"></div>
                    <div class="chat-input-container">
                        <textarea id="ai-chat-input" placeholder="Chiedi qualcosa all'assistente..." rows="2"></textarea>
                        <button id="ai-chat-send" class="btn btn-primary"><span class="material-icons">send</span></button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Document Import Tab -->
        <div id="document-import" class="tab-content">
            <div class="tab-header">
                <h2><span class="material-icons">description</span> Importa da Documenti</h2>
                <p>Carica PDF per creare lezioni e attività con l'IA.</p>
            </div>
            <div class="import-container">
                <input type="file" id="pdf-upload" accept=".pdf" style="display: none;">
                <button class="btn btn-primary" onclick="document.getElementById('pdf-upload').click();">
                    <span class="material-icons">upload_file</span> Seleziona PDF
                </button>
                <div id="pdf-upload-feedback"></div>
                
                <div id="pdf-import-options" style="display: none;">
                    <h3>Elabora il documento</h3>
                    <div class="form-actions">
                        <button class="btn btn-secondary" onclick="processPdfForLessons()">
                            <span class="material-icons">menu_book</span> Crea Lezione
                        </button>
                        <button class="btn btn-secondary" onclick="processPdfForActivities()">
                            <span class="material-icons">checklist</span> Estrai Attività
                        </button>
                    </div>
                    <div id="pdf-processing-output"></div>
                </div>
            </div>
        </div>

    </div>
    
    <div id="toast-container"></div>
    
    <script src="js/data.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/ai.js"></script>
    <script src="js/files.js"></script>
    <script src="js/events.js"></script>
    <script src="app.js"></script>
</body>
</html>
